<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ß üöÄ</title>
  <style>
    :root { --fg:#111; --bg:#fafafa; --accent:#0ea5e9; --muted:#6b7280; }
    *{box-sizing:border-box} body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--bg);color:var(--fg);margin:0}
    .wrap{max-width:560px;margin:4rem auto;padding:2rem;background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.07)}
    h1{margin:0 0 1.25rem;font-weight:800;letter-spacing:.2px}
    p.lead{margin:.25rem 0 1.5rem;color:var(--muted)}
    label{display:block;font-weight:600;margin:.75rem 0 .4rem}
    input{width:100%;padding:.85rem 1rem;border:1px solid #e5e7eb;border-radius:12px;font-size:16px;outline:none}
    input:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(14,165,233,.15)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:.9rem}
    .actions{display:flex;gap:.6rem;margin-top:1.2rem}
    button{appearance:none;border:0;background:var(--accent);color:#fff;padding:.9rem 1.2rem;border-radius:12px;font-weight:700;cursor:pointer}
    button[disabled]{opacity:.6;cursor:not-allowed}
    .ghost{background:#eef6ff;color:#0369a1}
    .note{font-size:.9rem;color:var(--muted);margin-top:.75rem}
    .toast{margin-top:1rem;padding:.85rem 1rem;border-radius:12px;display:none}
    .toast.ok{background:#ecfdf5;color:#065f46}
    .toast.err{background:#fef2f2;color:#991b1b}
    footer{margin-top:2rem;color:var(--muted);font-size:.85rem}
    .req{color:#ef4444}
  </style>
</head>
<body>
  <main class="wrap">
    <h1>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h1>
    <p class="lead">‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏¥‡∏ô‡πÑ‡∏õ‡∏•‡∏á Google Sheet ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‚úàÔ∏è</p>

    <form id="theForm">
      <div class="row">
        <div>
          <label for="firstName">‡∏ä‡∏∑‡πà‡∏≠ <span class="req">*</span></label>
          <input id="firstName" name="firstName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏ô‡∏±‡∏™" required />
        </div>
        <div>
          <label for="lastName">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="req">*</span></label>
          <input id="lastName" name="lastName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏à‡∏î‡∏µ" required />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="villageNo">‡∏´‡∏°‡∏π‡πà‡∏ó‡∏µ‡πà <span class="req">*</span></label>
          <input id="villageNo" name="villageNo" inputmode="numeric" pattern="^\d{1,3}$" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3" required />
        </div>
        <div>
          <label for="phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <span class="req">*</span></label>
          <input id="phone" name="phone" inputmode="tel" pattern="^0\d{8,9}$" placeholder="‡πÄ‡∏ä‡πà‡∏ô 0812345678" required />
        </div>
      </div>
      <div class="note">* ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏ó‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô 0 ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ 9‚Äì10 ‡∏´‡∏•‡∏±‡∏Å</div>

      <div class="actions">
        <button id="submitBtn" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ä‡∏µ‡∏ï</button>
        <button class="ghost" type="reset">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
      </div>

      <div id="toastOK" class="toast ok">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ</div>
      <div id="toastERR" class="toast err">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞ ‚ùå</div>
    </form>

    <footer>
      <div>Tips: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ <code>https://script.google.com/macros/s/AKfycbz6r7-ppO2D5n-yRHYTsTII6beJ_twn5kbHRGHgFsruWNV1B8EY8trbvrUIV6yKY8MkQQ/exec</code> ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå Web App ‡∏Ç‡∏≠‡∏á Google Apps Script</div>
    </footer>
  </main>

  <script>
    // üëâ ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Web App (‡∏à‡∏≤‡∏Å Apps Script) ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    const scriptUrl = "https://script.google.com/macros/s/AKfycbz6r7-ppO2D5n-yRHYTsTII6beJ_twn5kbHRGHgFsruWNV1B8EY8trbvrUIV6yKY8MkQQ/exec";

    const form = document.getElementById("theForm");
    const btn = document.getElementById("submitBtn");
    const ok = document.getElementById("toastOK");
    const err = document.getElementById("toastERR");

    function show(el){ el.style.display = "block"; setTimeout(()=> el.style.display = "none", 2600); }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!form.reportValidity()) return;

      btn.disabled = true; btn.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...";

      const data = {
        firstName: form.firstName.value.trim(),
        lastName: form.lastName.value.trim(),
        villageNo: form.villageNo.value.trim(),
        phone: form.phone.value.trim()
      };

      // ‡πÉ‡∏ä‡πâ x-www-form-urlencoded ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS/preflight
      const body = Object.entries(data)
        .map(([k,v]) => encodeURIComponent(k) + "=" + encodeURIComponent(v))
        .join("&");

      try {
        const res = await fetch(scriptUrl, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body
        });
        if (res.ok) {
          form.reset(); show(ok);
        } else { show(err); }
      } catch (e) {
        show(err);
      } finally {
        btn.disabled = false; btn.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏ä‡∏µ‡∏ï";
      }
    });
  </script>
</body>
</html>
